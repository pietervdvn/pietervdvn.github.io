{"version":3,"sources":["assets/themes/grb_import/grb.json"],"names":["module","exports","id","title","nl","shortDescription","description","en","language","maintainer","icon","version","startLat","startLon","startZoom","widenFactor","socialImage","clustering","maxZoom","overrideAll","minzoom","layers","builtin","isShown","render","override","calculatedTags","mapRendering","iconSize","location","name","source","osmTags","maxCacheAge","width","mappings","if","then","color","or","label","tagRenderings","freeform","key","question","de","and","hideInAnswer","type","filter","options","condition","geoJson","geoJsonZoomLevel","mercatorCrs","hideFromOverview","defaultBackgroundId","overpassMaxZoom","osmApiTileSize"],"mappings":"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","file":"grb.js","sourceRoot":"..","sourcesContent":["module.exports={id:\"grb\",title:{nl:\"GRB import helper\"},shortDescription:{nl:\"Grb import helper tool\"},description:{nl:\"Dit thema helpt het GRB importeren.\",en:\"This theme is an attempt to help automating the GRB import.<br/>Note that this is very hacky and 'steals' the GRB data from an external site; in order to do this, you need to install and activate <a href='https://addons.mozilla.org/en-US/firefox/addon/cors-everywhere/'>this firefox extension</a> for it to work.\"},language:[\"nl\",\"en\",\"de\"],maintainer:\"\",icon:\"./assets/svg/bug.svg\",version:\"0\",startLat:51.2132,startLon:3.231,startZoom:14,widenFactor:2,socialImage:\"\",clustering:{maxZoom:15},overrideAll:{minzoom:18},layers:[{builtin:\"type_node\",isShown:{render:\"no\"},override:{calculatedTags:[\"_is_part_of_building=feat.get('parent_ways')?.some(p => p.building !== undefined && p.building !== '') ?? false\",\"_is_part_of_building_passage=feat.get('parent_ways')?.some(p => p.tunnel === 'building_passage') ?? false\",\"_is_part_of_highway=!feat.get('is_part_of_building_passage') && (feat.get('parent_ways')?.some(p => p.highway !== undefined && p.highway !== '') ?? false)\",\"_is_part_of_landuse=feat.get('parent_ways')?.some(p => (p.landuse !== undefined && p.landuse !== '') || (p.natural !== undefined && p.natural !== '')) ?? false\"],mapRendering:[{icon:\"square:#00f\",iconSize:\"5,5,center\",location:\"point\"}]}},{id:\"OSM-buildings\",name:\"All OSM-buildings\",source:{osmTags:\"building~*\",maxCacheAge:0},calculatedTags:[\"_grbNumber=(feat.properties.fixme?.match(/GRB thinks that this has number ([^;]+)/ ) ?? ['','none']) [1]\"],mapRendering:[{width:{render:\"2\",mappings:[{if:\"fixme~*\",then:\"5\"}]},color:{render:\"#00c\",mappings:[{if:\"fixme~*\",then:\"#ff00ff\"},{if:\"building=house\",then:\"#a00\"},{if:\"building=shed\",then:\"#563e02\"},{if:{or:[\"building=garage\",\"building=garages\"]},then:\"#f9bfbb\"},{if:\"building=yes\",then:\"#0774f2\"}]}},{location:[\"point\",\"centroid\"],label:{mappings:[{if:\"addr:housenumber~*\",then:\"<div style='background-color: white; font: large; width: 1.5em; height: 1.5em; border-radius: 100%'>{addr:housenumber}</div>\"}]},iconSize:{render:\"40,40,center\"}}],title:\"OSM-gebouw\",tagRenderings:[{id:\"building type\",freeform:{key:\"building\"},render:\"The building type is <b>{building}</b>\",question:{en:\"What kind of building is this?\",de:\"Was ist das für ein Gebäude?\"},mappings:[{if:\"building=house\",then:\"A normal house\"},{if:\"building=detached\",then:\"A house detached from other building\"},{if:\"building=semidetached_house\",then:\"A house sharing only one wall with another house\"},{if:\"building=apartments\",then:\"An apartment building - highrise for living\"},{if:\"building=office\",then:\"An office building - highrise for work\"},{if:\"building=apartments\",then:\"An apartment building\"},{if:\"building=shed\",then:\"A small shed, e.g. in a garden\"},{if:\"building=garage\",then:\"A single garage to park a car\"},{if:\"building=garages\",then:\"A building containing only garages; typically they are all identical\"},{if:\"building=yes\",then:\"A building - no specification\"}]},{id:\"grb-housenumber\",render:{nl:\"Het huisnummer is <b>{addr:housenumber}</b>\"},question:{nl:\"Wat is het huisnummer?\"},freeform:{key:\"addr:housenumber\"},mappings:[{if:{and:[\"not:addr:housenumber=yes\",\"addr:housenumber=\"]},then:{nl:\"Geen huisnummer\"}},{if:{and:[\"addr:housenumber:={_grbNumber}\",\"fixme=\"]},then:\"Het huisnummer is <b>{_grbNumber}</b>, wat overeenkomt met het GRB\",hideInAnswer:{or:[\"_grbNumber=\",\"_grbNumber=none\",\"_grbNumber=no number\"]}},{if:{and:[\"addr:housenumber=\",\"not:addr:housenumber=yes\",\"fixme=\"]},then:\"Dit gebouw heeft geen nummer, net zoals in het GRB\",hideInAnswer:\"_grbNumber!=no number\"}]},{id:\"grb-unit\",question:\"Wat is de wooneenheid-aanduiding?\",render:{nl:\"De wooneenheid-aanduiding is <b>{addr:unit}</b> \"},freeform:{key:\"addr:unit\"},mappings:[{if:\"addr:unit=\",then:\"Geen wooneenheid-nummer\"}]},{id:\"grb-street\",render:{nl:\"De straat is <b>{addr:street}</b>\"},freeform:{key:\"addr:street\"},question:{nl:\"Wat is de straat?\"}},{id:\"grb-fixme\",render:{nl:\"De fixme is <b>{fixme}</b>\"},question:{nl:\"Wat zegt de fixme?\"},freeform:{key:\"fixme\"},mappings:[{if:{and:[\"fixme=\"]},then:{nl:\"Geen fixme\"}}]},{id:\"grb-min-level\",render:{nl:\"Dit gebouw begint maar op de {building:min_level} verdieping\"},question:{nl:\"Hoeveel verdiepingen ontbreken?\"},freeform:{key:\"building:min_level\",type:\"pnat\"}},\"all_tags\"],filter:[{id:\"has-fixme\",options:[{osmTags:\"fixme~*\",question:\"Heeft een FIXME\"}]}]},{id:\"All OSM objects\",name:\"All OSM Objects\",source:{osmTags:{and:[\"id~*\",\"landuse=\",\"place=\",\"disused:power=\",\"power=\",\"type!=boundary\",\"boundary=\",{or:[\"level=\",\"level=0\"]},{or:[\"layer=0\",\"layer=\"]}]},maxCacheAge:0},mapRendering:[{color:{render:\"#00c\"},width:{render:\"1\"}}],title:{render:{\"*\":\"OSM-Object\"}},tagRenderings:[\"all_tags\"]},{builtin:\"crab_address\",override:{\"calculatedTags+\":[\"_embedded_in=feat.overlapWith('OSM-buildings')[0]?.feat?.properties \",\"_embedding_nr=feat.get('_embedded_in')['addr:housenumber']\",\"_embedding_street=feat.get('_embedded_in')['addr:street']\",\"_embedding_id=feat.get('_embedded_in').id\"],isShown:{render:\"yes\",mappings:[{if:{and:[\"_embedding_nr:={HUISNR}\",\"_embedding_street:={STRAATNM}\"]},then:\"no\"}]},\"tagRenderings+\":[{id:\"render_embedded\",render:\"Het omliggende object met addres heeft <b>{_embedding_street}</b> {_embedding_nr}\",condition:{and:[\"_embedding_street~*\",\"_embedding_nr~*\"]}},{id:\"import-button\",render:\"{import_button(OSM-buildings, addr:street=$STRAATNM; addr:housenumber=$HUISNR,Import this address,,,OSM-buildings,5)}\"},{id:\"apply-button\",render:\"{tag_apply(addr:street=$STRAATNM; addr:housenumber=$HUISNR,Apply this address on the OSM-building,,_embedding_id)}\",condition:\"_embedded_in!=\"}]}},{id:\"GRB\",source:{osmTags:\"HUISNR~*\",geoJson:\"https://betadata.grbosm.site/grb?bbox={x_min},{y_min},{x_max},{y_max}\",geoJsonZoomLevel:18,mercatorCrs:!0,maxCacheAge:0},name:\"GRB geometries\",title:\"GRB outline\",calculatedTags:[\"_overlaps_with=feat.overlapWith('OSM-buildings').filter(f => f.overlap > 1 &&  (feat.get('_surface') < 20 || f.overlap / feat.get('_surface')) > 0.5)[0] ?? null\",\"_overlap_absolute=feat.get('_overlaps_with')?.overlap\",\"_overlap_percentage=Math.round(100 * feat.get('_overlap_absolute') / feat.get('_surface')) \",\"_osm_obj:source:ref=feat.get('_overlaps_with')?.feat?.properties['source:geometry:ref']\",\"_osm_obj:source:date=feat.get('_overlaps_with')?.feat?.properties['source:geometry:date'].replace(/\\\\//g, '-')\",\"_osm_obj:building=feat.get('_overlaps_with')?.feat?.properties.building\",\"_osm_obj:id=feat.get('_overlaps_with')?.feat?.properties.id\",\"_grb_ref=feat.properties['source:geometry:entity'] + '/' + feat.properties['source:geometry:oidn']\",\"_imported_osm_object_found= feat.properties['_osm_obj:source:ref'] == feat.properties._grb_ref\",\"_grb_date=feat.properties['source:geometry:date'].replace(/\\\\//g,'-')\",\"_imported_osm_still_fresh= feat.properties['_osm_obj:source:date'] == feat.properties._grb_date\",\"_target_building_type=feat.properties['_osm_obj:building'] === 'yes' ? feat.properties.building : (feat.properties['_osm_obj:building'] ?? feat.properties.building)\"],tagRenderings:[{id:\"Building info\",render:\"This is a <b>{building}</b> <span class='subtle'>detected by {detection_method}</span>\"},{id:\"overlapping building type\",render:\"<div>The overlapping openstreetmap-building is a <b>{_osm_obj:building}</b> and covers <b>{_overlap_percentage}%</b> of the GRB building<div><h3>GRB geometry:</h3>{minimap(21, id):height:10rem;border-radius:1rem;overflow:hidden}<h3>OSM geometry:</h3>{minimap(21,_osm_obj:id):height:10rem;border-radius:1rem;overflow:hidden}\",condition:\"_overlaps_with!=null\"},{id:\"apply-id\",render:\"{tag_apply(source:geometry:date=$_grb_date; source:geometry:ref=$_grb_ref,Mark the OSM-building as imported,,_osm_obj:id)}\",condition:{and:[\"_overlaps_with!=null\"]}},{id:\"apply-building-type\",render:\"{tag_apply(building=$building,Use the building type from GRB,,_osm_obj:id)}\",condition:{and:[\"_overlaps_with!=null\",\"_osm_obj:building=yes\",\"building!=yes\"]}},{id:\"Import-button\",render:\"{import_button(OSM-buildings,building=$building; source:geometry:date=$_grb_date; source:geometry:ref=$_grb_ref; addr:street=$addr:street; addr:housenumber=$addr:housenumber, Upload this building to OpenStreetMap)}\",mappings:[{if:\"_overlaps_with!=null\",then:\"{import_button(OSM-buildings,building=$_target_building_type; source:geometry:date=$_grb_date; source:geometry:ref=$_grb_ref, Replace the geometry in OpenStreetMap,,,_osm_obj:id)}\"}]},\"all_tags\"],isShown:{render:\"yes\",mappings:[{if:{and:[\"_imported_osm_object_found=true\",\"_imported_osm_still_fresh=true\"]},then:\"no\"}]},mapRendering:[{color:{render:\"#00a\",mappings:[{if:{and:[\"_imported_osm_object_found=true\",\"_imported_osm_still_fresh=true\"]},then:\"#0f0\"}]}}]},\"address\"],hideFromOverview:!0,defaultBackgroundId:\"AGIVFlandersGRB\",overpassMaxZoom:15,osmApiTileSize:17};"]}